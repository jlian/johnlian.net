{{ $paramDefault := .Site.Params.default_featured_image | default "images/default-featured.jpg" }}
{{ $rawImagePath := .Params.featured_image | default $paramDefault }}
{{ $scratch := newScratch }}
{{ partial "helpers/resource-image.html" (dict "path" $rawImagePath "page" . "size" "2500x q80" "scratch" $scratch) }}
{{ $imgUrl := $scratch.Get "img" }}
{{ $webpUrl := $scratch.Get "webp" }}
{{ $imgW := $scratch.Get "width" | default 0 }}
{{ $imgH := $scratch.Get "height" | default 0 }}
{{ $isLcp := .Scratch.Get "lcp_image" | default false }}
{{ $loading := cond $isLcp "eager" "lazy" }}
{{ $fetch := cond $isLcp "high" "auto" }}
<div class="mid-gray overflow-hidden bb-ns pv3 b--black-10">
  <div class="flex flex-column flex-row-ns">
    <div class="mb3 pr3-ns mb0-ns w-100 w-40-ns">
      <a href="{{ .RelPermalink }}" class="db dim aspect-ratio aspect-ratio--16x9">
        <div class="img aspect-ratio--object overflow-hidden flex" role="presentation" aria-hidden="true">
          <picture>
            {{ with $webpUrl }}<source type="image/webp" srcset="{{ . }}">{{ end }}
            <img
              src="{{ $imgUrl }}"
              alt="{{ .Title }}"
              loading="{{ $loading }}"
              fetchpriority="{{ $fetch }}"
              decoding="async"
              style="width:100%;height:100%;object-fit:cover;"
              {{ if and (gt $imgW 0) (gt $imgH 0) }}width="{{ $imgW }}" height="{{ $imgH }}"{{ end }}
            >
          </picture>
            <div class="bg-black-20 cover w-100 dn-ns">
                <div class="pa3">
                    <time class="f6 mb2 dib ttu tracked white-80">
                      {{ .Date.Format "January 2, 2006" }}
                    </time>
                    <h1 class="f3 measure-narrow lh-title mv0">
                      <span class="bg-black-50 lh-copy white pa1 tracked-tight sans-serif">
                        {{ .Title | default .Site.Title }}
                      </span>
                    </h1>
                  </div>
            </div>
        </div>
      </a>
    </div>
    <div class="w-100 w-60-ns pl3-ns dn dib-ns">
      {{ if .Date }}
        <div class="f7 dib ttu tracked">
          {{ .Date.Format "January 2, 2006" }}
        </div>
      {{ end }}
      <h1 class="f3 near-black">
        <a href="{{ .RelPermalink }}" class="link black dim">
          {{ .Title }}
        </a>
      </h1>
    </div>
  </div>
</div>
