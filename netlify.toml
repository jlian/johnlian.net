[build]
  command = "hugo --minify"
  publish = "public"

[build.environment]
  HUGO_VERSION = "0.152.2"
  HUGO_EXTENDED = "true"
  HUGO_ENV = "production"

[context.production]
  branch = "main"

[[redirects]]
  from = "/post/*"
  to = "/posts/:splat"
  status = 301

[[redirects]]
  from = "https://jlian.co/*"
  to = "https://johnlian.net/:splat"
  status = 301
  force = true

[[redirects]]
  from = "https://www.jlian.co/*"
  to = "https://johnlian.net/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/apple-touch-icon-precomposed.png"
  to = "/apple-touch-icon.png"
  status = 200

[[redirects]]
  from = "/apple-touch-icon-120x120.png"
  to = "/apple-touch-icon.png"
  status = 200

[[redirects]]
  from = "/apple-touch-icon-120x120-precomposed.png"
  to = "/apple-touch-icon.png"
  status = 200

[[redirects]]
  from = "/*/apple-touch-icon.png"
  to = "/apple-touch-icon.png"
  status = 200

[[headers]]
  for = "/site.webmanifest"
  [headers.values]
    Content-Type = "application/manifest+json; charset=utf-8"
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/favicon*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/android-chrome-*.png"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/favicon.svg"
  [headers.values]
    Content-Type = "image/svg+xml; charset=utf-8"

[[headers]]
  for = "/apple-touch-icon*.png"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"
